void f () { {scope_lock lock; foo();} {scope_lock lock; bar();} }